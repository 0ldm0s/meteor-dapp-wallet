<template name="views_send">

    <!-- we use a form, which posts into the "dapp-form-helper-iframe" iframe, so that the browser stores inout fields for native autocpmplete -->
    <form class="container account-send-form" action="about:blank" target="dapp-form-helper-iframe" autocomplete="on">
            
        <h1>{{{i18n 'wallet.send.title'}}}</h1>

        <!-- from/to -->
        <div class="row clear from-to">
            <div class="col col-4 mobile-full from">
                <h3>{{i18n 'wallet.send.from'}}</h3>

                {{> dapp_selectAccount accounts=fromAccounts showAccountTypes=true}}
            </div>

            <div class="col col-7 mobile-full send-info">
            </div>
            <div class="dapp-clear-fix"></div>

            <div class="col col-4 mobile-full">
                
                <h3>{{i18n 'wallet.send.to'}}</h3>

                {{> dapp_addressInput placeholder="0x000000.." name="to" autofocus=true disabled=showTo}}
                
            </div>
        </div>

        <!-- select action -->
        <div class="row clear select-action">
            <div class="col col-12 mobile-full">
                <h3>Action</h3>
                <div class="dapp-segmented-control select-action">
                    <input type="radio" value="send-ether" id="send-ether" name="select-action" checked> <label for="send-ether"> {{i18n 'wallet.send.sendEther'}} </label>
                    {{#if tokens}}
                    <input type="radio" value="send-token" id="send-token" name="select-action"> <label for="send-token"> {{i18n 'wallet.send.sendToken'}} </label>
                    {{/if}}
                    <input type="radio" value="upload-contract" id="upload-contract" name="select-action"> <label for="upload-contract"> {{i18n 'wallet.send.uploadContract'}} </label>
                </div>
            </div>

            <div class="col col-5 mobile-full send-info">
            </div>


            <div class="dapp-clear-fix"></div>
        </div> 

        {{#if TemplateVar.get "showSendToken"}}
        <!-- amount token -->
        <div class="row clear token-amount">
            <div class="col col-3 mobile-full">
                <h3>{{i18n 'wallet.send.tokenAmount'}}</h3>
                <input type="number" min="0" step="any" name="token-amount" placeholder="0.0" class="dapp-large">

            </div>
             <div class="col col-4 mobile-full">
                <br><br>
                {{#if tokens}}
                 <ul class="select-token unselected">
                    {{#each tokens}}
                    <li>
                        <input type="radio" id="token-{{address}}" value="{{address}}"  name="choose-token"> 
                        <label for="token-{{address}}"> 
                            {{> dapp_identicon identity=address class="dapp-tiny"}} 
                            <span class="token-name">{{name}}</span>
                            <span class="balance">{{formattedCoinBalance}}</span>
                        </label>
                    </li>
                    {{/each}}
                </ul>
                {{/if}}
            </div>
            
            <div class="col col-5 mobile-full send-info">
                <br><br>
                {{{sendExplanation amount=amount}}}
            </div>


            <div class="dapp-clear-fix"></div>
        </div>

        {{else}}
        <!-- amount -->
        <div class="row clear amount">
            <div class="col col-7 mobile-full">
                <h3>{{i18n 'wallet.send.amount'}}</h3>
                <input type="number" min="0" step="any" name="amount" placeholder="0.0" class="dapp-large"><span> {{unit.toUpperCase}}</span>
            </div>
            
            <div class="col col-5 mobile-full send-info">
                <br><br>
                {{{i18n 'wallet.send.texts.sendAmount' amount=amount}}}
                {{TemplateVar.get "dailyLimitText"}}
            </div>


            <div class="dapp-clear-fix"></div>
        </div>
        {{/if}}

        
        <div class="row clear data">
            <div class="col col-7 mobile-full">

                {{#if TemplateVar.get "showData"}}
                    <button class="hide-data">{{{i18n 'wallet.send.removeData'}}}</button>

                    <h3>{{i18n 'wallet.send.data'}}</h3>

                    <textarea class="solidity-source" id="solidity-data" cols="20" rows="10"></textarea>
                    
                    <div class="constructors">
                        {{{TemplateVar.get "constructors"}}}
                    </div>
                    {{> dapp_dataTextarea cols="20" rows="8"}}



                    {{TemplateVar.set "dataShown" true}}
                {{else}}
                    <button class="show-data">{{{i18n 'wallet.send.addData'}}}</button>
                {{/if}}
            </div>
            
            <div class="col col-5 mobile-full send-info">
                {{#if TemplateVar.get "showData"}}
                    <br><br>
                    {{{i18n 'wallet.send.texts.addData'}}}

                    {{#if TemplateVar.get "codeNotExecutable"}}
                        <p class="orange">
                            <i class="icon-shield"></i> {{i18n 'wallet.send.texts.dataNotExecutable'}}
                        </p>
                    {{/if}}
                {{/if}}
            </div>


            <div class="dapp-clear-fix"></div>
        </div>

        <!-- fee -->
        <div class="row clear">
            <div class="col col-7 mobile-full">
                <h3>{{i18n 'wallet.send.fee'}}</h3>

                {{> dapp_selectGasPrice gas=estimatedGas gasPrice=latestBlock.gasPrice}}
            </div>
            
            <div class="col col-5 mobile-full send-info">
                <br><br>
                {{{i18n 'wallet.send.texts.sendFee' timetext=timeText}}}

                {{#if $eq estimatedGas 0}}
                    <p class="orange">
                        <i class="icon-info"></i> {{i18n 'wallet.send.texts.cantEstimateGas'}}
                    </p>
                {{/if}}
            </div>

            <div class="dapp-clear-fix"></div>
        </div>

        <!-- Total -->
        <div class="row clear total">
            <div class="col col-12 mobile-full">
                <h3>Total</h3>
                <span class="amount">{{total}}</span>
                {{#if $neq unit 'ether'}}
                    <br>
                    ({{total 'ether'}})
                {{/if}}
            </div>

            <div class="dapp-clear-fix"></div>
        </div>

        <hr>
        <!-- button type="submit" will send the form -->
        <button type="submit" class="dapp-block-button">
            {{#if TemplateVar.get "sending"}} 
                {{i18n 'buttons.sending'}}
            {{else}}
                {{i18n 'buttons.send'}}
            {{/if}}
        </button>
        
    </form>

</template>